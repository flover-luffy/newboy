# 🤖 Newboy - 多功能QQ机器人插件

> 基于Mirai框架的QQ机器人插件，支持口袋48、微博、微店等多平台内容监控和推送

[![Mirai](https://img.shields.io/badge/Mirai-2.16.0-blue)](https://github.com/mamoe/mirai)
[![Kotlin](https://img.shields.io/badge/Kotlin-2.0+-purple)](https://kotlinlang.org/)
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

## ✨ 主要功能

- 📱 **口袋48监控** - 房间动态、在线状态、多媒体推送
- 🐦 **微博监控** - 用户动态、超话内容实时推送
- 🛍️ **微店管理** - 订单监控、自动发货、商品管理
- 🔍 **在线状态** - 实时查询、批量监控、变化通知
- 🎵 **音频处理** - 智能格式转换、QQ兼容优化

## 🚀 快速开始

1. 将插件jar文件放入Mirai插件目录
2. 启动Mirai Console
3. 使用 `!newboy help` 查看帮助信息
4. 根据需要配置各项功能

## 💬 命令使用

### 系统命令（推荐使用）

使用 `!` 或 `#` 前缀，避免与QQ原生命令冲突：

- `!newboy info` 或 `!nb 信息` - 查看插件状态
- `!newboy config` 或 `!nb 配置` - 查看配置信息
- `!newboy subscribe` 或 `!nb 订阅` - 查看订阅详情
- `!newboy help` 或 `!nb 帮助` - 显示帮助信息

### 功能命令

#### 群聊命令
- `/口袋 搜索 <关键词>` - 搜索成员/队伍
- `/口袋 关注 <房间ID>` - 关注房间动态
- `/口袋 关注列表` - 查看关注列表
- `/微博 关注 <用户UID>` - 关注微博用户
- `/超话 关注 <超话ID>` - 关注超话
- `/在线 <成员名>` - 查询在线状态

#### 管理员命令（私聊）
- `/帮助` - 显示帮助信息
- `/清理` - 清理失效配置
- `/口袋 关注 <房间ID> <群号>` - 跨群管理
- `/微博 关注 <UID> <群号>` - 跨群管理
- `/微店 <群号> cookie <值>` - 微店配置

## 🚀 技术特性

### 核心功能
- **多平台消息处理**: 支持QQ群聊、私聊消息的智能处理
- **口袋48集成**: 完整的SNH48/BEJ48/GNZ48等团体消息推送
- **实时监控**: 成员动态、直播状态实时推送
- **智能过滤**: 可配置的消息过滤和转发规则
- **统一命令系统**: 简化的`/监控`命令，支持中英文别名

### 先进架构设计
- **统一资源管理**: UnifiedResourceManager统一管理所有系统资源
- **自适应线程池**: 根据CPU使用率动态调整线程池大小(2-4核心线程)
- **智能负载均衡**: CpuLoadBalancer实时监控系统负载，动态切换处理策略
- **事件驱动架构**: EventBusManager提供高效的事件发布订阅机制
- **统一调度管理**: UnifiedSchedulerManager管理所有定时任务，支持并发限制

### 高性能处理引擎
- **CPU感知调度**: 根据CPU使用率智能选择处理策略
- **优先级队列**: 文本消息优先于媒体消息处理
- **异步处理**: 基于CompletableFuture的高性能异步消息处理
- **多线程优化**: 媒体处理池(1-4线程)和消息处理池(1-3线程)动态调整
- **资源管理**: 自动临时文件清理，智能内存监控
- **错误恢复**: 完善的异常处理和自动重试机制

### 智能监控系统
- **实时性能监控**: 线程池状态、CPU负载、内存使用情况
- **事件总线监控**: 事件发布频率、处理延迟、失败率统计
- **自适应调整**: 根据系统负载自动调整处理参数
- **详细日志系统**: 分级日志、组件日志、事件日志
- **性能分析**: 提供详细的性能分析报告和组件状态查询

## 👥 权限说明

- **普通用户** - 可使用群聊查询命令
- **群管理员** - 可管理本群订阅配置
- **超级管理员** - 可通过私聊管理所有群组配置

## 📝 配置要求

- 口袋48功能需要Token或账号密码配置
- 微博功能需要相应Cookie配置
- 音频转换功能需要安装FFmpeg
- 建议定期清理失效的群组配置

---

**基于 [Mirai](https://github.com/mamoe/mirai) 框架开发**
